{"ast":null,"code":"var _jsxFileName = \"/home/quan/Downloads/g/goodpicker-main/frontend/src/pages/goods/seller-info/index.js\",\n    _s = $RefreshSig$();\n\nimport './style.scss';\nimport React from 'react';\nimport axios from 'axios';\nimport { Skeleton, Avatar } from 'antd';\nimport { MessageOutlined, PhoneOutlined } from '@ant-design/icons';\nimport AuthService from '../../../service/AuthService';\nimport { Link, useHistory } from 'react-router-dom';\nimport { useAuthState, useAuthenticate } from '../../../hooks/useAuth';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst SellerInfo = _ref => {\n  _s();\n\n  let {\n    sellerId\n  } = _ref;\n  const [seller, setSeller] = React.useState(null);\n  const unmountedRef = React.useRef(false);\n  React.useEffect(() => {\n    unmountedRef.current = false;\n\n    const getSeller = async () => {\n      try {\n        const res = await axios.get(`/api/users/${sellerId}`);\n\n        if (!unmountedRef.current) {\n          setSeller(res.data);\n        }\n      } catch (error) {\n        setSeller({\n          message: 'Đã xảy ra lỗi trong quá trình lấy thông tin người đăng'\n        });\n      }\n    };\n\n    getSeller();\n    return () => {\n      unmountedRef.current = true;\n    };\n  }, [sellerId]);\n\n  const renderSkeleton = () => /*#__PURE__*/_jsxDEV(Skeleton, {\n    active: true\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 38,\n    columnNumber: 31\n  }, this);\n\n  const {\n    user,\n    cookies\n  } = useAuthState();\n  const authenticate = useAuthenticate();\n  const history = useHistory();\n\n  const createChatRoom = async () => {\n    const contact = user.contacts.find(_ref2 => {\n      let {\n        partner\n      } = _ref2;\n      return partner.id === seller.id;\n    });\n\n    if (contact) {\n      history.push(`/chat/${contact.chatId}`);\n    } else {\n      try {\n        const chatRes = await axios.post('/api/chats/', {\n          participants: [user.id, seller.id]\n        }, {\n          headers: {\n            Authorization: `Bearer ${cookies['gp_token']}`\n          }\n        });\n        const userRes = await AuthService.getMe(cookies['gp_token']);\n        authenticate({\n          user: userRes.data,\n          token: cookies['gp_token']\n        });\n        history.push(`/chat/${chatRes.data.id}`);\n      } catch (error) {\n        history.push('/login');\n      }\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"seller-card\",\n    children: seller ? seller.message ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"seller-card__error\",\n      children: seller.message\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 6\n    }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"seller-card-info\",\n        children: [seller.userImage ? /*#__PURE__*/_jsxDEV(Avatar, {\n          size: 60,\n          src: seller.userImage,\n          className: \"seller-card-info__avatar\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 84,\n          columnNumber: 9\n        }, this) : /*#__PURE__*/_jsxDEV(Avatar, {\n          size: 60,\n          className: \"seller-card-info__avatar seller-card-info__avatar--default\",\n          children: seller.username[0].toUpperCase()\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 90,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"seller-card-info__username\",\n            children: seller.username\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 98,\n            columnNumber: 9\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"seller-card-info__location\",\n            children: seller.userProvinceID.userProvinceName\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 101,\n            columnNumber: 9\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 97,\n          columnNumber: 8\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"seller-card-contact\",\n        children: [/*#__PURE__*/_jsxDEV(Link, {\n          to: `/users/${seller.id}`,\n          className: \"seller-card-contact__btn\",\n          children: \"Xem h\\u1ED3 s\\u01A1\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 108,\n          columnNumber: 8\n        }, this), seller.id !== user.id ? /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"seller-card-contact__btn\",\n          onClick: createChatRoom,\n          children: [\"Li\\xEAn h\\u1EC7 \", /*#__PURE__*/_jsxDEV(MessageOutlined, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 120,\n            columnNumber: 18\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 116,\n          columnNumber: 9\n        }, this) : null, seller.userPhoneNumber ? /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"seller-card-contact__btn seller-card-contact__btn--phone\",\n          children: [seller.userPhoneNumber, \" \", /*#__PURE__*/_jsxDEV(PhoneOutlined, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 126,\n            columnNumber: 35\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 125,\n          columnNumber: 9\n        }, this) : null]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 7\n      }, this)]\n    }, void 0, true) : renderSkeleton()\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 76,\n    columnNumber: 3\n  }, this);\n};\n\n_s(SellerInfo, \"ZuWzyOyW9HNyu+gTI068nuQ//g8=\", false, function () {\n  return [useAuthState, useAuthenticate, useHistory];\n});\n\n_c = SellerInfo;\nexport default SellerInfo;\n\nvar _c;\n\n$RefreshReg$(_c, \"SellerInfo\");","map":{"version":3,"sources":["/home/quan/Downloads/g/goodpicker-main/frontend/src/pages/goods/seller-info/index.js"],"names":["React","axios","Skeleton","Avatar","MessageOutlined","PhoneOutlined","AuthService","Link","useHistory","useAuthState","useAuthenticate","SellerInfo","sellerId","seller","setSeller","useState","unmountedRef","useRef","useEffect","current","getSeller","res","get","data","error","message","renderSkeleton","user","cookies","authenticate","history","createChatRoom","contact","contacts","find","partner","id","push","chatId","chatRes","post","participants","headers","Authorization","userRes","getMe","token","userImage","username","toUpperCase","userProvinceID","userProvinceName","userPhoneNumber"],"mappings":"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","sourcesContent":["import './style.scss'\n\nimport React from 'react'\nimport axios from 'axios'\nimport { Skeleton, Avatar } from 'antd'\nimport { MessageOutlined, PhoneOutlined } from '@ant-design/icons'\nimport AuthService from '../../../service/AuthService'\nimport { Link, useHistory } from 'react-router-dom'\nimport { useAuthState, useAuthenticate } from '../../../hooks/useAuth'\n\nconst SellerInfo = ({ sellerId }) => {\n\tconst [seller, setSeller] = React.useState(null)\n\tconst unmountedRef = React.useRef(false)\n\n\tReact.useEffect(() => {\n\t\tunmountedRef.current = false\n\t\tconst getSeller = async () => {\n\t\t\ttry {\n\t\t\t\tconst res = await axios.get(`/api/users/${sellerId}`)\n\n\t\t\t\tif (!unmountedRef.current) {\n\t\t\t\t\tsetSeller(res.data)\n\t\t\t\t}\n\t\t\t} catch (error) {\n\t\t\t\tsetSeller({\n\t\t\t\t\tmessage: 'Đã xảy ra lỗi trong quá trình lấy thông tin người đăng'\n\t\t\t\t})\n\t\t\t}\n\t\t}\n\n\t\tgetSeller()\n\n\t\treturn () => {\n\t\t\tunmountedRef.current = true\n\t\t}\n\t}, [sellerId])\n\n\tconst renderSkeleton = () => <Skeleton active />\n\n\tconst { user, cookies } = useAuthState()\n\tconst authenticate = useAuthenticate()\n\tconst history = useHistory()\n\tconst createChatRoom = async () => {\n\t\tconst contact = user.contacts.find(\n\t\t\t({ partner }) => partner.id === seller.id\n\t\t)\n\n\t\tif (contact) {\n\t\t\thistory.push(`/chat/${contact.chatId}`)\n\t\t} else {\n\t\t\ttry {\n\t\t\t\tconst chatRes = await axios.post(\n\t\t\t\t\t'/api/chats/',\n\t\t\t\t\t{\n\t\t\t\t\t\tparticipants: [user.id, seller.id]\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\theaders: {\n\t\t\t\t\t\t\tAuthorization: `Bearer ${cookies['gp_token']}`\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t)\n\n\t\t\t\tconst userRes = await AuthService.getMe(cookies['gp_token'])\n\n\t\t\t\tauthenticate({ user: userRes.data, token: cookies['gp_token'] })\n\n\t\t\t\thistory.push(`/chat/${chatRes.data.id}`)\n\t\t\t} catch (error) {\n\t\t\t\thistory.push('/login')\n\t\t\t}\n\t\t}\n\t}\n\n\treturn (\n\t\t<div className=\"seller-card\">\n\t\t\t{seller ? (\n\t\t\t\tseller.message ? (\n\t\t\t\t\t<div className=\"seller-card__error\">{seller.message}</div>\n\t\t\t\t) : (\n\t\t\t\t\t<>\n\t\t\t\t\t\t<div className=\"seller-card-info\">\n\t\t\t\t\t\t\t{seller.userImage ? (\n\t\t\t\t\t\t\t\t<Avatar\n\t\t\t\t\t\t\t\t\tsize={60}\n\t\t\t\t\t\t\t\t\tsrc={seller.userImage}\n\t\t\t\t\t\t\t\t\tclassName=\"seller-card-info__avatar\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t<Avatar\n\t\t\t\t\t\t\t\t\tsize={60}\n\t\t\t\t\t\t\t\t\tclassName=\"seller-card-info__avatar seller-card-info__avatar--default\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{seller.username[0].toUpperCase()}\n\t\t\t\t\t\t\t\t</Avatar>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<div className=\"seller-card-info__username\">\n\t\t\t\t\t\t\t\t\t{seller.username}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div className=\"seller-card-info__location\">\n\t\t\t\t\t\t\t\t\t{seller.userProvinceID.userProvinceName}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div className=\"seller-card-contact\">\n\t\t\t\t\t\t\t<Link\n\t\t\t\t\t\t\t\tto={`/users/${seller.id}`}\n\t\t\t\t\t\t\t\tclassName=\"seller-card-contact__btn\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\tXem hồ sơ\n\t\t\t\t\t\t\t</Link>\n\n\t\t\t\t\t\t\t{seller.id !== user.id ? (\n\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\tclassName=\"seller-card-contact__btn\"\n\t\t\t\t\t\t\t\t\tonClick={createChatRoom}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\tLiên hệ <MessageOutlined />\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t) : null}\n\n\t\t\t\t\t\t\t{seller.userPhoneNumber ? (\n\t\t\t\t\t\t\t\t<div className=\"seller-card-contact__btn seller-card-contact__btn--phone\">\n\t\t\t\t\t\t\t\t\t{seller.userPhoneNumber} <PhoneOutlined />\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t) : null}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</>\n\t\t\t\t)\n\t\t\t) : (\n\t\t\t\trenderSkeleton()\n\t\t\t)}\n\t\t</div>\n\t)\n}\n\nexport default SellerInfo\n"]},"metadata":{},"sourceType":"module"}